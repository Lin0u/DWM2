<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suscripci√≥n Semanal - FitExpress</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .day-selector input[type="checkbox"] {
            display: none;
        }
        .day-selector label {
            background-color: var(--color-card-dark);
            border: 1px solid var(--color-text-secondary);
            color: var(--color-text-secondary);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .day-selector input[type="checkbox"]:checked + label {
            background-color: var(--color-accent-primary);
            border-color: var(--color-accent-primary);
            color: var(--color-bg-dark);
            font-weight: bold;
        }
        .summary-item {
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
            padding-bottom: 8px;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container-fluid container">
            <a class="navbar-brand logo" href="index.html">ü•ó FitExpress</a>
            <div class="d-flex">
                <a class="nav-link text-light me-3" href="CarritoCompra.html">üõí Carrito</a>
                <a class="nav-link text-light" href="index.html">üè† Men√∫</a>
            </div>
        </div>
    </nav>

    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xl-7">
                <div class="card card-bowl p-4 p-md-5">
                    <h2 class="text-center mb-4 text-warning">Configura tu Suscripci√≥n Semanal</h2>
                    <p class="text-center text-secondary mb-5">Recibe tu bowl favorito de forma autom√°tica y disfruta de un 10% de descuento fijo.</p>

                    <div class="row g-4">
                        <div class="col-md-6">
                            <h5 class="text-light mb-3">Tu Bowl Favorito</h5>
                            <div class="d-flex align-items-center mb-3">
                                <img id="sub-product-image" src="img/Bowl Pollo.jpg" class="card-img-top me-3" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px;" alt="Bowl de Suscripci√≥n">
                                <div>
                                    <h5 id="sub-product-name" class="mb-0">Bowl Pollo Teriyaki</h5>
                                    <p id="sub-product-price" class="text-warning mb-0">$7.990 CLP</p>
                                </div>
                            </div>
                            <button id="change-bowl-btn" class="btn btn-sm btn-outline-secondary mb-4">Cambiar Bowl</button>
                            
                            <h5 class="text-light mb-2">M√©todo de Pago</h5>
                            <p class="text-secondary">Tarjeta Visa **** 1234</p>
                            <a href="#" class="text-warning small">Cambiar/A√±adir Tarjeta</a>
                        </div>

                        <div class="col-md-6">
                            <h5 class="text-light mb-3">¬øCu√°ndo quieres recibirlo?</h5>
                            <div class="day-selector d-flex justify-content-between mb-3">
                                <input type="checkbox" id="d-l" name="day" value="L"><label for="d-l">L</label>
                                <input type="checkbox" id="d-m" name="day" value="M"><label for="d-m">M</label>
                                <input type="checkbox" id="d-mi" name="day" value="Mi"><label for="d-mi">Mi</label>
                                <input type="checkbox" id="d-j" name="day" value="J"><label for="d-j">J</label>
                                <input type="checkbox" id="d-v" name="day" value="V"><label for="d-v">V</label>
                                <input type="checkbox" id="d-s" name="day" value="S"><label for="d-s">S</label>
                                <input type="checkbox" id="d-d" name="day" value="D"><label for="d-d">D</label>
                            </div>
                            
                            <p class="mt-2 mb-4 text-secondary"><input type="checkbox" id="recurrent" checked> Recurrente cada semana</p>

                            <h5 class="text-light mt-4 mb-3">Resumen del Pedido</h5>
                            <div class="summary-item d-flex justify-content-between">
                                <span>Bowl (<span id="count-bowls">2</span>x/semana)</span>
                                <span id="subtotal-amount" class="fw-bold">$15.980</span>
                            </div>
                            <div class="summary-item d-flex justify-content-between">
                                <span>Descuento Suscripci√≥n (10%)</span>
                                <span id="discount-amount" class="text-danger fw-bold">-$1.598</span>
                            </div>
                            <div class="d-flex justify-content-between pt-2">
                                <h5 class="mb-0">Total semanal</h5>
                                <h5 id="total-amount" class="text-success mb-0">$14.382</h5>
                            </div>
                        </div>
                    </div>

                    <button id="confirm-sub-btn" class="btn btn-primary btn-lg mt-5 py-3">
                        Confirmar Suscripci√≥n
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        function formatCurrency(number) {
            return '$' + Math.round(number).toLocaleString('es-CL');
        }

        const DISCOUNT_RATE = 0.10;
        let selectedProduct = null;
        let selectedDays = 2;

        function initializeProduct() {
            // Usa el primer producto de la lista global 'products' (Bowl Pollo)
            selectedProduct = products[0]; 
            
            document.getElementById('sub-product-image').src = selectedProduct.image;
            document.getElementById('sub-product-name').textContent = selectedProduct.name;
            document.getElementById('sub-product-price').textContent = formatCurrency(selectedProduct.price);
            
            // Marca d√≠as iniciales
            document.getElementById('d-l').checked = true;
            document.getElementById('d-j').checked = true;
            
            updateSummary();
        }

        function updateSummary() {
            const bowlPrice = selectedProduct ? selectedProduct.price : 0;
            
            const dayCheckboxes = document.querySelectorAll('.day-selector input[type="checkbox"]:checked');
            selectedDays = dayCheckboxes.length;
            
            const subtotal = bowlPrice * selectedDays;
            const discount = subtotal * DISCOUNT_RATE;
            const total = subtotal - discount;

            document.getElementById('count-bowls').textContent = selectedDays;
            document.getElementById('subtotal-amount').textContent = formatCurrency(subtotal);
            document.getElementById('discount-amount').textContent = formatCurrency(discount);
            document.getElementById('total-amount').textContent = formatCurrency(total);
        }

        document.querySelectorAll('.day-selector input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', updateSummary);
        });

        document.getElementById('confirm-sub-btn').addEventListener('click', () => {
            if (selectedDays === 0) {
                alert('‚ö†Ô∏è Debes seleccionar al menos un d√≠a para recibir tu bowl.');
                return;
            }
            
            const success = Math.random() > 0.3; // 70% de √©xito

            if (success) {
                alert(`¬°Suscripci√≥n Exitosa! Se cobrar√° ${document.getElementById('total-amount').textContent} semanalmente por tu ${selectedProduct.name}.`);
            } else {
                alert('‚ùå Error en la suscripci√≥n. Int√©ntalo de nuevo o verifica tu m√©todo de pago.');
            }
        });
        
        document.getElementById('change-bowl-btn').addEventListener('click', () => {
            alert('üõ†Ô∏è Se abrir√≠a una ventana o p√°gina para que elijas tu nuevo Bowl favorito de la lista.');
        });


        document.addEventListener('DOMContentLoaded', initializeProduct);
    </script>
</body>
</html>
